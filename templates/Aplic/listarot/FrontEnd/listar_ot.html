{% extends 'layout.html' %}
{% block content %}
<link rel="stylesheet" href="/static/css/apps/listar_ot.css">

<div class="container-fluid full-height py-3">
    <h1 class="text-center" style="color: #1f9336;">Ã“rdenes de Mantenimiento</h1>
    <h2 id="contador-filas" class="text-white text-center mb-4">
        Cantidad total de ordenes: {{ num_filas }}
    </h2>

    <!-- Selector de archivo -->
    <div class="mb-3">
        <label class="text-white">Seleccionar fecha de archivo:</label>
        <select id="archivoSelector" class="form-select" onchange="cambiarArchivo()">
            {% for archivo, fecha in selector %}
            <option value="{{ archivo }}" {% if archivo==archivo_actual %}selected{% endif %}>
                {{ fecha }}
            </option>
            {% endfor %}
        </select>
    </div>

    <!-- GrÃ¡fico -->
    <div class="grafico-container mb-4">
        <canvas id="graficoTorta"></canvas>
    </div>

    <!-- Selector de columna y bÃºsqueda -->
    <div class="mb-3 row g-2">
        <div class="col-md-6">
            <select id="columnaSelector" class="form-select" onchange="generarGrafico()">
                <option value="">Seleccionar columna a graficar</option>
            </select>
        </div>
        <div class="col-md-6">
            <input type="text" id="busqueda" class="form-control" onkeyup="buscar()"
                placeholder="Buscar en la tabla..." />
        </div>
    </div>

    <!-- Tabla -->
    <div class="table-responsive tabla-scroll sticky-header">
        {# ðŸ”¹ Reemplazar valores vacÃ­os por "sin valor" #}
        {% set safe_tables = tables | replace('><td></td><', '><td>sin valor</td><') %}
        {{ safe_tables | safe }}
    </div>
</div>

<!-- Contenedor para cargar modales -->
<div id="modalContainer"></div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/apps/listar_ot.js') }}"></script>
{% endblock %}
